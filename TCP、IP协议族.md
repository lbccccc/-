# TCP / IP 协议族

####  概念

 ⼀系列协议所组成的⼀个⽹络分层模型 

#### 为什么要分层？

 因为⽹络的不稳定性

#### 具体分层：

 Application Layer 应⽤层：HTTP、FTP、DNS 

Transport Layer 传输层：TCP、UDP

 Internet Layer ⽹络层：IP 

Link Layer 数据链路层：以太⽹、Wi-Fi

## 分层原理（大概)

- IP： 解决在网络上传输包的问题，例如网络寻址、以包为单位发送网络数据，只关心传输的地址，其他的都无关

- TCP：用于保证网络数据的可靠传输。传输层，用于传输文件的，因为网络永远是不稳定的，所以为了防止整个文件发送时全部丢失，TCP会把文件分成几部分再去分别传输，这样能使损失最小，然后如果遇到了部分文件丢失，会重新发送。而UDP和TCP同属于传输层，和TCP一样也是把文件分成几部分再传输，但是如果部分文件丢失就不管了，所以可以用于游戏，直播等实时的不太重要的数据。TCP传输的数据就相对重要一点。

TCP在IP的上层，TCP把文件打包好之后让IP去传输

## TCP 连接

###  什么叫做连接

 通信双⽅建⽴确认「可以通信」，不会将对⽅的消息丢弃，即为「建⽴连接」

###  TCP 连接的建⽴与关闭

- ###### 建立

三次握手：大概意思如下

第一次：a给b发消息 表明想要通信

第二次：b返回给a收到，并表明b也想要通信

第三次：a返回收到

- ###### 关闭

四次挥手：大概意思如下

第一次：a给b发消息表明想要关闭通信

第二次：b返回给a收到

第三次：b返回给a，b想要关闭通信（之所以第二次和第三次会分开发两次是因为此时b可能正在和a发消息中，等待消息传输完成再关闭通信）

第四次：a返回收到

### 长连接

##### 为什么要⻓连接？

因为移动⽹络并不在 Internet 中，⽽是在运营商的内⽹，并不具有真正的公⽹ IP，因此当某个 TCP 连接在⼀段时间不通信之后，⽹关会出于⽹络性能考虑⽽关闭这条 TCP 连接和公⽹的连接通道，导致 这个 TCP 端⼝不再能收到外部通信消息，即 TCP 连接被动关闭。

##### ⻓连接的实现⽅式 ⼼跳。

即在⼀定间隔时间内，使⽤ TCP 连接发送超短⽆意义消息来让⽹关不能将⾃⼰定义为「空闲连 接」，从⽽防⽌⽹关将⾃⼰的连接关闭。

# HTTPS

### 定义 

HTTP over SSL 的简称，即⼯作在 SSL （或 TLS）上的 HTTP。其实就是加密通信的 HTTP

#### 工作原理

在客户端和服务器之间协商出⼀套对称密钥，每次发送信息之前将内容加密，收到之后解密，达到内容的加密传输

#### 为什么不直接⽤⾮对称加密

⾮对称加密由于使⽤了复杂了数学原理，因此计算相当复杂，如果完全使⽤⾮对称加密来加密通信内 容，会严重影响⽹络通信的性能，但是服务器和客户端之间的对称密钥是通过非对称加密来传输的

##### HTTPS 连接建⽴的过程（省略了很多，懒得写了，看视频复习）

建立过程都是在TCP层完成

1. Client Hello
2.  Server Hello 
3. 服务器证书(三层) 信任建⽴ 
4.  Pre-master Secret 
5.  客户端通知：将使⽤加密通信 
6. 客户端发送：Finished 
7. 服务器通知：将使⽤加密通信
8. 服务器发送：Finished

## 错题
* 十六题 HTTPS连接的过程中证书的作用是让客户端确信和自己通信的对象确实是自己所认为的对象


2020.7.2 1:32
